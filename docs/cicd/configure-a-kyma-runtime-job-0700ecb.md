<!-- loio0700ecb0e9a6475cb51759371a1e5c14 -->

# Configure a Kyma Runtime Job

The Kyma Runtime pipeline allows you to build your SAP Cloud Application Programming Model \(CAP\) application, transform it into Docker images, and deploy it to the Kubernetes-based Kyma Runtime environment of SAP BTP. You can configure the stages of your Kyma Runtime job directly in the SAP Continuous Integration and Delivery service.



<a name="loio0700ecb0e9a6475cb51759371a1e5c14__prereq_h3b_412_gzb"/>

## Prerequisites

-   You have the Administrator role for SAP Continuous Integration and Delivery. See [Assigning Roles and Permissions](assigning-roles-and-permissions-c679ebd.md).

-   In your source code management system, you have an SAP Cloud Application Programming Model project with the recommended files and folder structure for deploying to a Kyma runtime. See the [CAP documentation](https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fcap.cloud.sap%2Fdocs%2Fget-started%2F).

-   You have a container registry or a Docker Hub account to store your container images.

-   You provisioned the Kyma environment in your SAP BTP cockpit subaccount. See [Getting Started in the Kyma Environment](https://help.sap.com/viewer/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/d1abd18556f24fb091d081b2e3454b8b.html?q=prerequisites%20kubernetes%20cluster%20or%20sap%20kyma%20environment).




## Context

Depending on your configuration, your Kyma Runtime job can comprise the following stages:

> ### Tip:  
> Hover over the arrow shapes for a short description of each stage.

![](images/Kyma_Pipeline_Steps_245059f.png)

> ### Note:  
> When the pipeline run is complete, an additional **Declarative: Post Actions** stage is executed to perform finalization tasks. The outcome of the **Declarative: Post Actions** stage doesn't influence the success of your build.



## Procedure

1.  Configure a new job in SAP Continuous Integration and Delivery with the *Pipeline* option *Kyma Runtime*, as described in [Create a Job](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/create-job?version=Cloud).

2.  In the *Stages* tab, choose *Configuration Mode* \> *Job Editor*.

    > ### Note:  
    > After you configure your job, export the editor-based configuration information to a YAML file by pressing the *YML* button. If needed, you can select *Edit* and switch to **Source Repository** to move from editor-based configuration to the more advanced configuration in the source repository. For more information, see [\(Optional\) Export Job Configuration Data](https://help.sap.com/viewer/99c72101f7ee40d0b2deb4df72ba1ad3/Cloud/en-US/60a76d7b5a2a46f684515b18e9cbbc08.html).

    1.  Configure the *General Parameters*.

        **Actions for General Parameters**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Chart Path
        
        </td>
        <td valign="top">
        
        The path to the Helm chart in your source repository. To learn how to generate the relevant files, see [About CAP Helm Chart](https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fcap.cloud.sap%2Fdocs%2Fguides%2Fdeployment%2Fdeploy-to-kyma%23about-cap-helm).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Container Images
        
        </td>
        <td valign="top">
        
        Specify container images to be created during the Build stage. At least one container image must be specified.

        ****


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Container Image Name
        
        </td>
        <td valign="top">
        
        Define the image name \(part of the repository\) where the generated image shall be pushed to. The repository is defined as `[REGISTRY_HOST_NAME[:PORT]]/[NAME]` 
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Project Subdirectory Path
        
        </td>
        <td valign="top">
        
        Define the path to the project subdirectory containing the sources and build results used for this image. This can be a directory that already exists in the source repository or a directory generated by the \(cds\) build.

        > ### Note:  
        > For Maven, define the path to the build result \(e.g. `.jar` file\) instead of a directory.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Container Image Tag
        
        </td>
        <td valign="top">
        
        Define an optional image tag for the image to be pushed. If nothing is specified, 'latest' is used.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Tag Path
        
        </td>
        <td valign="top">
        
        During the deployment of the Helm chart, the image tag \(sha digest\) and repository \(the repository is defined as `[REGISTRY_HOST_NAME[:PORT]]/[NAME]`\) of the generated image are injected as Helm values.

        In this field, define the path in the Helm values to the tag parameter of this image \(e.g. `myApp.image.tag`\).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Repository Path
        
        </td>
        <td valign="top">
        
        During the deployment of the Helm chart, the image tag \(sha digest\) and repository \(the repository is defined as \[REGISTRY\_HOST\_NAME\[:PORT\]\]/\[NAME\]\) of the generated image are injected as Helm values.

        In this field, define the path in the Helm values to the repository parameter of this image \(e.g. `myApp.image.repository`\).
        
        </td>
        </tr>
        </table>
        

        
        </td>
        </tr>
        </table>
        
    2.  Configure the **Build** stage.

        **Actions for Configuring the Build Stage**


        <table>
        <tr>
        <th valign="top">

        Step
        
        </th>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top" rowspan="3">
        
        Â 
        
        </td>
        <td valign="top">
        
        Build Tool
        
        </td>
        <td valign="top">
        
        From the dropdown list, choose the build tool \(mta , npm, or maven\) you want to use.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Build Tool Version
        
        </td>
        <td valign="top">
        
        Choose the build tool version you want to use. For more information, see [Supported Tools](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/supported-tools?version=Cloud).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Script
        
        </td>
        <td valign="top">
        
        Specify the npm script in your `package.json` to run in the Build stage. For CAP projects, you probably want to run a script that executes the "cds" tool to generate the required CAP sources.

        > ### Note:  
        > This parameter can only be activated for the **npm** build tool.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Maven Static Code Checks
        
        </td>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the Maven Static Code Checks step *On* or *Off*.

        Maven static code checks verify the syntax of your Java code.

        > ### Note:  
        > This parameter can only be activated for the **mta** or **maven** build tool.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Lint Check
        
        </td>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the Lint Check step *On* or *Off*.

        Lint check verifies the syntax of your JavaScript code.

        If you want your build to fail when the Lint check reveals errors, select *Fail on Error*.
        
        </td>
        </tr>
        <tr>
        <td valign="top" rowspan="2">
        
        CNB Build \(Container image build based on Cloud Native Buildpacks\)
        
        </td>
        <td valign="top">
        
        Container Registry URL
        
        </td>
        <td valign="top">
        
        Enter the URL of the container registry where you want to push the built container images.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Container Registry Credential
        
        </td>
        <td valign="top">
        
        Select a **Container Registry Configuration** registry credential with permissions to push images to the specified container registry. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).
        
        </td>
        </tr>
        <tr>
        <td valign="top" rowspan="2">
        
        Helm Dependency Update
        
        </td>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the **Helm Dependency Update** step *On* or *Off*.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Repository Credentials
        
        </td>
        <td valign="top">
        
        Specify optional credentials needed to access a Helm repository during the Helm Dependency Update step.


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Name
        
        </td>
        <td valign="top">
        
        Enter the name of the dependency as defined in the `Chart.yaml`.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        URL
        
        </td>
        <td valign="top">
        
        Enter the URL of the dependencies Helm repository.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Credentials
        
        </td>
        <td valign="top">
        
        Select the credentials to use when authenticating at the Helm repository. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).
        
        </td>
        </tr>
        </table>
        

        
        </td>
        </tr>
        </table>
        
    3.  Configure the **Additional Unit Tests** stage.

        **Actions for Configuring the Additional Unit Tests Stage**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the **Additional Unit Tests** step *On* or *Off*.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        npm Script
        
        </td>
        <td valign="top">
        
        \(Optional\) If you have a scripts section in your `package.json` file, specify the name of the test script to execute.
        
        </td>
        </tr>
        </table>
        
    4.  Configure the **Acceptance** stage.

        **General Actions for the Acceptance Stage**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the **Acceptance** step *On* or *Off*.
        
        </td>
        </tr>
        </table>
        
        **Actions for Configuring the Deploy to Kyma Step**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Kubernetes Configuration Credential
        
        </td>
        <td valign="top">
        
        **Kubernetes Configuration** credentials used to access the Kyma cluster. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Kubernetes Namespace
        
        </td>
        <td valign="top">
        
        The Kyma namespace where the Helm release should be deployed.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Release Name
        
        </td>
        <td valign="top">
        
        The name of the Helm release that is shown in the Kyma namespace. Start with an alphanumeric character and only use lowercase alphanumeric characters, - characters, or . characters.

        > ### Note:  
        > The - characters and . characters can't be next to each other.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Files
        
        </td>
        <td valign="top">
        
        To override values in a chart during deployment, you can pass in \(a\) `YAML` file\(s\) with values. See `--values` parameter in the [Helm Install documentation](https://helm.sh/docs/helm/helm_install/).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Values
        
        </td>
        <td valign="top">
        
        To override values in a chart during deployment, you can set specific values. See `--set parameter` in [Helm Install documentation](https://helm.sh/docs/helm/helm_install/).


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Path
        
        </td>
        <td valign="top">
        
        The path to the chart value to set, for example, `app.logging.level`.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Value
        
        </td>
        <td valign="top">
        
        The value to set, for example, `debug`.
        
        </td>
        </tr>
        </table>
        

        
        </td>
        </tr>
        </table>
        
        **Actions for Configuring the WebdriverIO Test Step**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the **WebdriverIO Test** step *On* or *Off*.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        npm Script
        
        </td>
        <td valign="top">
        
        Enter the name of the test script to execute. You can find it in the scripts section of your `package.json` file. If you don't define a name, a default one \("wdi5"\) is used.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Base URL
        
        </td>
        <td valign="top">
        
        Enter the URL of the application where the tests are executed. See [Configuring Application URLs](https://help.sap.com/viewer/65de2977205c403bbc107264b8eccf4b/Cloud/en-US/e623e372e6174f81af2b9b8ef8f6d6d3.html).

        > ### Note:  
        > If you don't know the URL, you can deploy your application first. You should find this information in the Kyma dashboard in the *Discovery and Network* \> *Services* section of your namespace.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Credentials
        
        </td>
        <td valign="top">
        
        \(Optional\) To authenticate your pipeline against the application, create a **Basic Authentication** credential for a user who has the appropriate permissions. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).

        > ### Note:  
        > Avoid using a personal user credential and create a special test user instead. Choose the credential from the dropdown list. You can access the username and password in your individual test files by using:
        > 
        > ```
        > const usernameVar=process.env.e2e_username
        > const passwordVar=process.env.e2e_password
        > ```


        
        </td>
        </tr>
        </table>
        
    5.  Configure the **Compliance** stage.

        **Actions for Configuring the Compliance Settings**


        <table>
        <tr>
        <th valign="top">

        Step
        
        </th>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top" rowspan="7">
        
        SonarQube Scan
        
        </td>
        <td valign="top">
        
        State
        
        </td>
        <td valign="top">
        
        Switch the execution of the **SonarQube Scan** step *On* or *Off*.

        This step enables you to integrate code quality and security analysis into your pipeline. If you choose to enable the SonarQube Scan step, make sure you have a running SonarQube server instance. See [SonarQube](https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fwww.sonarqube.org%2F). You can also use the public offering - SonarCloud.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Mode
        
        </td>
        <td valign="top">
        
        Select the mode to use when analyzing your application. The following options are displayed in a dropdown list:

        -   SonarCloud
        -   SonarQube


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Cloud Connector
        
        </td>
        <td valign="top">
        
        \(Optional\) If you chose the SonarQube mode, you can additionally connect to on-premise systems using Cloud Connector. See [Cloud Connector](https://help.sap.com/docs/connectivity/sap-btp-connectivity-cf/cloud-connector?version=Cloud).

        From the dropdown list, either choose credentials that you've already defined in [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud) or create new ones by choosing **Create Credentials**.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        URL
        
        </td>
        <td valign="top">
        
        Enter the full URL to your backend system:

        -   For the SonarCloud mode, choose the URL from the dropdown list.

        -   For the SonarQube mode, enter the custom URL to your internet-facing SonarQube server.


        > ### Note:  
        > If you configured your Cloud Connector, this must be an HTTP URL \(not HTTPS\).
        > 
        > Before configuring the next parameters, make sure that you created a project in your SonarQube instance. For more information, see the[SonarQube documentation](https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fdocs.sonarqube.org%2Flatest%2Fsetup%2Fget-started-2-minutes%2F).


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Organization
        
        </td>
        <td valign="top">
        
        If you are using SonarCloud mode, this is mandatory.

        Enter the organization that you provided for your project.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Project Key
        
        </td>
        <td valign="top">
        
        Enter the project key that you provided for your project.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Sonar Qube Token Credentials
        
        </td>
        <td valign="top">
        
        To authenticate your pipeline, create a **Secret Text** credential for a user who has the appropriate permissions. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).

        In the *Secret* field, paste the token that was generated when you created your SonarQube project. If you are unable to retrieve your token, generate a new one. See [Generating and Using Tokens](https://help.sap.com/docs/link-disclaimer?site=https%3A%2F%2Fdocs.sonarqube.org%2Flatest%2Fuser-guide%2Fuser-token%2F).

        Choose this credential from the dropdown list.
        
        </td>
        </tr>
        </table>
        
    6.  Configure the **Release** stage.

        **Actions for Configuring the Release Stage**


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Kubernetes Configuration Credential
        
        </td>
        <td valign="top">
        
        **Kubernetes Configuration** credentials used to access the Kyma cluster. See [Creating Credentials](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/creating-credentials?version=Cloud).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Kubernetes Namespace
        
        </td>
        <td valign="top">
        
        The Kyma namespace where the Helm release should be deployed.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Release Name
        
        </td>
        <td valign="top">
        
        The name of the Helm release that is shown in the Kyma namespace. Start with an alphanumeric character and only use lowercase alphanumeric characters, - characters, or . characters.

        > ### Note:  
        > The - characters and . characters can't be next to each other.


        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Files
        
        </td>
        <td valign="top">
        
        To override values in a chart during deployment, you can pass in \(a\) `YAML` file\(s\) with values. See `--values` parameter in the [Helm Install documentation](https://helm.sh/docs/helm/helm_install/).
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Values
        
        </td>
        <td valign="top">
        
        To override values in a chart during deployment, you can set specific values. See `--set parameter` in [Helm Install documentation](https://helm.sh/docs/helm/helm_install/).


        <table>
        <tr>
        <th valign="top">

        Parameter
        
        </th>
        <th valign="top">

        Value
        
        </th>
        </tr>
        <tr>
        <td valign="top">
        
        Helm Value Path
        
        </td>
        <td valign="top">
        
        The path to the chart value to set, for example, `app.logging.level`.
        
        </td>
        </tr>
        <tr>
        <td valign="top">
        
        Value
        
        </td>
        <td valign="top">
        
        The value to set, for example, `debug`.
        
        </td>
        </tr>
        </table>
        

        
        </td>
        </tr>
        </table>
        
        > ### Note:  
        > You can add environment variables to provide additional configuration to each stage. They only apply to the stage where they're defined. For more information, see [Advanced Pipeline Configuration](https://help.sap.com/docs/continuous-integration-and-delivery/sap-continuous-integration-and-delivery/advanced-pipeline-configuration?version=Cloud).


3.  Choose *Create*.


